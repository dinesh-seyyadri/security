1)

Access the console of Site3-Rtr and display the crypto map that is configured.

Site3-Rtr>enable
Site3-Rtr#sh run | section crypto map
crypto map VPNMAP 10 ipsec-isakmp 
 description Tunnel to Site 4
 set peer 192.168.4.2
 set transform-set ESP-AES-SHA 
 match address Site3-to-Site4
crypto map VPNMAP 20 ipsec-isakmp 
 description Tunnel to Site 2
 set peer 192.168.2.2
 set transform-set ESP-AES-SHA 
 match address Site3-to-Site1
crypto map VPNMAP 30 ipsec-isakmp 
 description Tunnel to Site 1
 set peer 192.168.1.2
 set transform-set ESP-AES-SHA 
 match address Site3-to-Site1
 crypto map VPNMAP
 
 ###
 
 Note the following:
 
 There is one crypto map defined. It is named VPNMAP and it has three entries (10, 20, and 30). 
 Based on the descriptions, you can guess that there is an entry in the crypto map for each of the other three sites.
 Kayla has fully configured Site3-Rtr and Site4-Rtr. In later discoveries, you will configure Site2-Rtr and Site1-ASA to complete site-to-site tunnels to Site 3.
 The last line in the output (crypto map VPNMAP) appears to be under the crypto map VPNMAP 30 configuration, but, actually, it is not under that configuration. 
 It is under the configuration of interface Gi0/2. This command assigns this crypto map to that interface.
 
 2)
 VPNMAP entry 10 defines the characteristics of the tunnel to Site 4.
 While the commands appear in a different order in the configuration, logically, the first consideration is what needs to be protected.
 This is done with the match address command. This command references an ACL. 
 Traffic that is permitted by the ACL is what should be protected in this particular tunnel. 
 Matched traffic is often referred to as “interesting” traffic.VPN entry 10 specifies match address Site3-to-Site4. 
 Display the referenced ACL.
 
 ####
 
 Site3-Rtr#show access-list Site3-to-Site4
 Extended IP access list Site3-to-Site4
    10 permit ip 10.10.3.0 0.0.0.255 10.10.4.0 0.0.0.255
    
    All IP traffic sourced from 10.10.3.0/24 and destined to 10.10.4.0/24 matches the ACL. 
    Matching traffic is interesting and will be protected by IPsec.

####
 
3)
The second consideration is how to protect the interesting traffic. 
The set transform-set command that is specified in the crypto map entry defines how to protect interesting traffic.
Like the match address command, set transform-set references a construct that is defined elsewhere in the configuration.
Display the IPsec transform sets that are defined in the Site3-Rtr configuration.

##

Site3-Rtr#show run | section crypto ipsec
crypto ipsec transform-set ESP-AES-SHA esp-aes esp-sha-hmac 
 mode tunnel
 
##
Note the following:

The transform-set name is ESP-AES-SHA. The transform set is referenced in the crypto map by this name. 
It is common to use a name that describes the transform set settings but it is not necessary.

The two arguments, esp-aes and esp-sha-hmac, actually define the crypto technologies that are used.
Encapsulating Security Payload (ESP) is the protocol that is commonly used by IPsec. 
You can specify one ESP encryption algorithm and one ESP hash-based message authentication algorithm.

There is another protocol that can be used by IPsec called Authentication Header (AH).
It can be used alone, or in combination with ESP. You can specify an AH authentication algorithm.
AH cannot provide privacy. It is not commonly used in networks today.

The default mode is tunnel mode. The alternative is transport mode.
Transport mode maintains the original IP header and only protects the data that is contained in the original IP packet. 
Transport mode can be used to protect traffic between the router itself and another specific device.
When protecting packets sent between systems other than the router, tunnel mode is appropriate, unless another tunneling protocol, such as Generic Router Encapsulation, is used to provide a new IP header. 


4)

The third consideration is where to send the protected packet. 
This is configured with the set peer statement in a crypto map entry.
As you have seen, VPNMAP entry number 10 specifies 192.168.4.2 as the peer. 
The Site4-Rtr is the peer for this crypto map entry.

5)

There are other factors that can be configured for an IPsec tunnel, but they all have default values.
What to protect, how to protect, and where to send the protected traffic are all dependent on the scenario and there cannot be default values. 
As long as the default values for the other parameters are left in place between the two peers, an IPsec tunnel can be negotiated. 
You will look deeper into this later in the discovery. 
For now, display all the settings of the crypto map, including the default settings, with the command show crypto map.

Site3-Rtr#show crypto map
Crypto Map IPv4 "VPNMAP" 10 ipsec-isakmp
        Description: Tunnel to Site 4
        Peer = 192.168.4.2
        Extended IP access list Site3-to-Site4
            access-list Site3-to-Site4 permit ip 10.10.3.0 0.0.0.255 10.10.4.0 0.0.0.255
        Current peer: 192.168.4.2
        Security association lifetime: 4608000 kilobytes/3600 seconds
        Responder-Only (Y/N): N
        PFS (Y/N): N
        Mixed-mode : Disabled
        Transform sets={ 
                ESP-AES-SHA:  { esp-aes esp-sha-hmac  } , 
        }

<…Output for other crypto map entries omitted…>



